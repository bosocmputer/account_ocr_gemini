// prompt_multiimage.go - Multi-Image Processing Steps
//
// ไฟล์นี้เก็บขั้นตอนการประมวลผลเอกสารหลายรูป
// รวมถึงการวิเคราะห์ความสัมพันธ์ระหว่างเอกสาร

package ai

// GetMultiImageProcessingSteps returns the steps for multi-image document analysis
// This guides the AI in determining document relationships and processing order
func GetMultiImageProcessingSteps() string {
	return `🔍 ขั้นตอนที่ 1: กำหนดความสัมพันธ์ของเอกสาร

วิเคราะห์รูปภาพและจำแนกความสัมพันธ์:

A. **เอกสาร + หลักฐานการชำระเงิน** (เอกสาร + สลิปโอนเงิน):
   - รูปที่ 1: เอกสารทางบัญชีใดก็ได้ (ใบเสร็จ, ใบกำกับภาษี, ใบแจ้งหนี้, บิลค่าสาธารณูปโภค)
   - รูปที่ 2: สลิปโอนเงินหรือหลักฐานการชำระเงิน
   - จำนวนเงินเท่ากันหรือไม่? ✓ → เป็นเอกสารเดียวกัน
   - การดำเนินการ: ใช้ข้อมูลจากเอกสาร + วิธีชำระเงินจากสลิป

B. **เอกสารหลายหน้า** (ใบเสร็จแบ่งหลายหน้า):
   - หลายรูปที่มีเลขเอกสารเดียวกัน
   - ต่อเนื่องกัน (เช่น หน้า 1/3, 2/3, 3/3)
   - การดำเนินการ: รวมข้อมูลจากทุกหน้าเป็นเอกสารเดียว

C. **เอกสารแยกกัน** (ใบเสร็จหลายใบ):
   - แต่ละรูปมีเลขเอกสารต่างกัน
   - วันที่และผู้ขายอาจเหมือนหรือต่างกัน
   - การดำเนินการ: สร้าง journal entry แยกสำหรับแต่ละเอกสาร

D. **เอกสารเดี่ยว** (รูปเดียว):
   - มีเพียงรูปเดียว
   - การดำเนินการ: วิเคราะห์ตามปกติ

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 ขั้นตอนที่ 2: ระบุบทบาทของเรา (ผู้ซื้อ หรือ ผู้ขาย?)

เปรียบเทียบชื่อในเอกสารกับ Shop Context:

1. **หาชื่อบริษัทจากเอกสาร**:
   - ส่วนบนของเอกสาร: "ชื่อผู้ออกเอกสาร"
   - ส่วนรับเงิน/จ่ายเงิน: "ชื่อผู้รับ/ผู้จ่าย"

2. **เปรียบเทียบกับชื่อบริษัทเรา** (จาก Shop Context):
   - ถ้าชื่อบริษัทเราตรงกับ "ผู้ออกเอกสาร" → เราเป็น **ผู้ขาย**
   - ถ้าชื่อบริษัทเราตรงกับ "ผู้รับสินค้า/บริการ" → เราเป็น **ผู้ซื้อ**

3. **กำหนด Creditor/Debtor**:
   - เราเป็นผู้ซื้อ → คู่ค้าคือ **Creditor** (เจ้าหนี้) → ค้นหาจาก Creditors list
   - เราเป็นผู้ขาย → คู่ค้าคือ **Debtor** (ลูกหนี้) → ค้นหาจาก Debtors list

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔍 ขั้นตอนที่ 3: สร้าง Journal Entry

ทำตามลำดับ:
1. ✅ เลือก Journal Book ตามประเภทเอกสาร (ดู Journal Book Selection Rules)
2. ✅ ระบุ Creditor/Debtor code (ถ้าหาไม่เจอ → null)
3. ✅ สร้าง entries[] ตาม Template (ถ้ามี) หรือตามหลักบัญชี
4. ✅ คำนวณ total_debit และ total_credit
5. ✅ ตรวจสอบ balance (Debit = Credit?)
6. ✅ เพิ่ม ai_explanation พร้อมเหตุผลทุกขั้นตอน

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 สรุป: ขั้นตอนการประมวลผลหลายรูป
1. วิเคราะห์ความสัมพันธ์ระหว่างรูป (A/B/C/D)
2. ระบุว่าเราเป็นผู้ซื้อหรือผู้ขาย
3. จับคู่ Creditor/Debtor จาก Master Data
4. สร้าง Journal Entry ตามหลักบัญชี
5. Validate และอธิบายเหตุผล

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━`
}
